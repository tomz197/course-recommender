import{_ as e,r as s,j as t,a1 as r,e as o,a2 as n,a3 as l,a4 as a,a5 as c,a6 as i,a7 as u,a8 as d,H as m}from"./recommendations-CuwkqNkm.js";import{_ as x}from"./visualization-Dke5IIPu.js";import{u as f}from"./index-_O5JNQhc.js";import"./plotly-vendor-Co-r0fb2.js";const{allFacultySearch:h}=await x((async()=>{const{allFacultySearch:e}=await import("./all_code_name_faculty-bvPI52XB.js");return{allFacultySearch:e}}),[]),p=e=>e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),g=h.map((e=>({course:e,code:p(e.CODE),name:p(e.NAME)}))),j=async(e,s)=>{if(!e)return[];const t=(e=>{const s=p(e).trim();if(!s)return[];const t=g.filter((({code:e,name:t})=>e.includes(s)||t.includes(s)));return t.sort(((e,t)=>{const{code:r,name:o}=e,{code:n,name:l}=t;if(r===s&&n!==s)return-1;if(n===s&&r!==s)return 1;if(o===s&&l!==s)return-1;if(l===s&&o!==s)return 1;const a=r.indexOf(s),c=n.indexOf(s);return-1!==a&&-1!==c?a-c:-1!==a?-1:-1!==c?1:o.indexOf(s)-l.indexOf(s)})),t.map((({course:e})=>e))})(e);return t.slice(0,s)};function y({onSelectCourse:n,placeholder:l="Search courses...",excludeCourses:a=[]}){const[c,i]=s.useState(!1),[u,d]=s.useState(""),m=s.useRef(null),x=s.useRef(null),{data:f=[],isLoading:h}=function(s,t=100){return e({queryKey:["courses",s],queryFn:()=>j(s,t),staleTime:3e5})}(u,100),p=s.useMemo((()=>f.length?f.filter((e=>!a.some((s=>s.CODE===e.CODE)))):[]),[f,a]);s.useEffect((()=>{const e=e=>{m.current&&x.current&&!m.current.contains(e.target)&&!x.current.contains(e.target)&&i(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[]);const g=e=>{n(e),d(""),i(!1)};return t.jsxs("div",{className:"relative w-full",children:[t.jsx("div",{className:"relative",children:t.jsx("input",{ref:m,type:"text",value:u,onChange:e=>{const s=e.target.value;d(s),s.length>0?i(!0):i(!1)},onKeyDown:e=>{"Enter"===e.key&&c&&p.length>0&&!h&&(e.preventDefault(),g(p[0]))},onFocus:()=>u.length>0&&i(!0),placeholder:l,className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"})}),c&&t.jsx("div",{ref:x,className:"absolute z-10 mt-1 w-full rounded-md border border-input bg-background shadow-md",children:h?t.jsxs("div",{className:"flex items-center justify-center p-4",children:[t.jsx(r,{className:"h-4 w-4 animate-spin text-muted-foreground"}),t.jsx("span",{className:"ml-2 text-sm text-muted-foreground",children:"Searching courses..."})]}):p.length>0?t.jsxs("ul",{className:"max-h-60 overflow-auto py-1",children:[p.map((e=>t.jsxs("li",{onClick:()=>g(e),className:o("px-3 py-2 text-sm cursor-pointer hover:bg-accent hover:text-accent-foreground","transition-colors duration-150"),children:[t.jsxs("div",{className:"font-medium",children:[e.CODE," - ",e.FACULTY]}),e.NAME&&t.jsx("div",{className:"text-xs text-muted-foreground truncate",children:e.NAME})]},e.CODE))),100===p.length?t.jsxs("li",{className:"px-3 py-2 text-sm text-center text-muted-foreground",children:["Showing first ",100," results. Try a more specific search term."]}):null]}):u.length>0?t.jsx("div",{className:"p-4 text-sm text-muted-foreground text-center",children:"No courses found. Try a different search term."}):null})]})}function v(){const e=f(),{likedCourses:s,dislikedCourses:r,addLikedCourse:o,addDislikedCourse:x,removeLikedCourse:h,removeDislikedCourse:p}=n();return t.jsxs("main",{className:"container mx-auto px-1 sm:px-4 py-4 sm:p-8 md:py-12",children:[t.jsxs("div",{className:"flex flex-col items-center text-center mb-12",children:[t.jsx("h1",{className:"text-2xl sm:text-3xl md:text-4xl lg:text-5xl font-bold tracking-tight mb-4",children:"MUNI Course Recommendation"}),t.jsx("p",{className:"text-sm sm:text-lg text-muted-foreground max-w-2xl",children:"Help us understand your preferences by selecting courses you like and dislike, and we'll recommend courses tailored to your interests."})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-12",children:[t.jsxs(l,{className:"h-full",children:[t.jsxs(a,{children:[t.jsx(c,{children:"Courses You Like"}),t.jsx(i,{children:"Select courses that interest you or that you've enjoyed in the past"})]}),t.jsxs(u,{className:"space-y-4 flex flex-col justify-between flex-1",children:[t.jsx(d,{courses:Array.from(s.values()),onRemove:h,emptyMessage:"No liked courses selected yet",title:"Liked courses"}),t.jsx(y,{onSelectCourse:o,placeholder:"Search for courses you like...",excludeCourses:[...s.values(),...r.values()]})]})]}),t.jsxs(l,{className:"h-full",children:[t.jsxs(a,{children:[t.jsx(c,{children:"Courses You Dislike"}),t.jsx(i,{children:"Select courses that don't interest you or that you didn't enjoy"})]}),t.jsxs(u,{className:"space-y-4 flex flex-col justify-between flex-1",children:[t.jsx(d,{courses:Array.from(r.values()),onRemove:p,emptyMessage:"No disliked courses selected yet",title:"Disliked courses"}),t.jsx(y,{onSelectCourse:x,placeholder:"Search for courses you dislike...",excludeCourses:[...s.values(),...r.values()]})]})]})]}),t.jsxs("div",{className:"flex flex-col justify-center sm:items-center",children:[t.jsx(m,{size:"lg",onClick:()=>{e("/recommendations")},disabled:0===s.size,children:"Get Course Recommendations"}),0===s.size&&t.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Select at least one course you like to get recommendations"})]})]})}export{v as default};
